#!/usr/bin/env bash

function main {
  local args=()
  while [[ "$#" -gt 0 ]]; do
    case "$1" in
      --)
        shift # --
        local cmd_remote=
        while [[ "$#" -gt 0 ]]; do
          cmd_remote="${cmd_remote:+"$cmd_remote "}$(printf '%q' "$1")"
          shift
        done
      ;;
      *)
        args+=("$1"); shift
        ;;
    esac
  done


  exec ansible ${cmd_remote:+-a "${cmd_remote}"} "${args[@]}"
}

source sub "$0" "$@"
